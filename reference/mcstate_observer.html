<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create observer — mcstate_observer • mcstate2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create observer — mcstate_observer"><meta name="description" content="Create an observer to extract additional details from your model
during the sampling process."><meta property="og:description" content="Create an observer to extract additional details from your model
during the sampling process."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcstate2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mcstate2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dsl-errors.html">DSL parse errors</a></li>
    <li><a class="dropdown-item" href="../articles/dsl.html">Probabilistic DSL</a></li>
    <li><a class="dropdown-item" href="../articles/samplers.html">Samplers</a></li>
    <li><a class="dropdown-item" href="../articles/samples.html">Working with samples</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/mcstate2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create observer</h1>
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/mcstate2/blob/main/R/observer.R" class="external-link"><code>R/observer.R</code></a></small>
      <div class="d-none name"><code>mcstate_observer.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create an observer to extract additional details from your model
during the sampling process.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcstate_observer</span><span class="op">(</span><span class="va">observe</span>, finalise <span class="op">=</span> <span class="cn">NULL</span>, combine <span class="op">=</span> <span class="cn">NULL</span>, append <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-observe">observe<a class="anchor" aria-label="anchor" href="#arg-observe"></a></dt>
<dd><p>A function that will run with arguments <code>model</code>
(the model that you passed in to <a href="mcstate_model.html">mcstate_model</a>) and <code>rng</code> (an
rng object).  This function should return a list.  It is best if
the list returned is named, with no duplicated names, and with
return values that have the same exact dimensions for every
iteration.  If you do this, then you will not have to provide
any of the following arguments, which are going to be hard to
describe and worse to implement.</p></dd>


<dt id="arg-finalise">finalise<a class="anchor" aria-label="anchor" href="#arg-finalise"></a></dt>
<dd><p>A function that runs after a single chain has run,
and you use to simplify across all samples drawn from that
chain.  Takes a single argument which is the list with one set
of observations per sample.</p></dd>


<dt id="arg-combine">combine<a class="anchor" aria-label="anchor" href="#arg-combine"></a></dt>
<dd><p>A function that runs after all chains have run, and
you use to simplify across chains.  Takes a single argument,
which is the list with one set of observations per chain.</p></dd>


<dt id="arg-append">append<a class="anchor" aria-label="anchor" href="#arg-append"></a></dt>
<dd><p>A function that runs after a continuation of chain
has run (via <a href="mcstate_sample_continue.html">mcstate_sample_continue</a>.  Takes two arguments
representing the fully simplified observations from the first
and second chains.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object with class <code>mcstate_observer</code> which can be
passed in to <code>mcstate_sample</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Sometimes you want to extract additional information from your
model as your chain runs.  The case we see this most is when
running MCMC with a particle filter (pmcmc); in this case while
the likelihood calculation is running we are computing lots of
interesting quantities such as the final state of the system
(required for onward simulation) and filtered trajectories through
time.  Because these are stochastic we can't even just rerun the
model with our sampled parameter sets, because the final states
that are recovered depend also on the random number generators
(practically we would not want to, as it is quite expensive to
compute these quantities).</p>
<p>The observer mechanism allows you to carry out arbitrary
additional calculations with your model at the end of the step.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

