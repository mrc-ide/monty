<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nested Random Walk Sampler — mcstate_sampler_nested_random_walk • mcstate2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nested Random Walk Sampler — mcstate_sampler_nested_random_walk"><meta name="description" content="Create a nested random walk sampler, which uses a symmetric
proposal for separable sections of a model to move around in
parameter space.  This sampler supports sampling from models where
the likelihood is only computable randomly (e.g., for pmcmc), and
requires that models support the has_parameter_groups property."><meta property="og:description" content="Create a nested random walk sampler, which uses a symmetric
proposal for separable sections of a model to move around in
parameter space.  This sampler supports sampling from models where
the likelihood is only computable randomly (e.g., for pmcmc), and
requires that models support the has_parameter_groups property."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcstate2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mcstate2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dsl-errors.html">DSL parse errors</a></li>
    <li><a class="dropdown-item" href="../articles/dsl.html">Probabilistic DSL</a></li>
    <li><a class="dropdown-item" href="../articles/samplers.html">Samplers</a></li>
    <li><a class="dropdown-item" href="../articles/samples.html">Working with samples</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/mcstate2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Nested Random Walk Sampler</h1>
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/mcstate2/blob/main/R/sampler-nested-random-walk.R" class="external-link"><code>R/sampler-nested-random-walk.R</code></a></small>
      <div class="d-none name"><code>mcstate_sampler_nested_random_walk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a nested random walk sampler, which uses a symmetric
proposal for separable sections of a model to move around in
parameter space.  This sampler supports sampling from models where
the likelihood is only computable randomly (e.g., for pmcmc), and
requires that models support the <code>has_parameter_groups</code> property.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcstate_sampler_nested_random_walk</span><span class="op">(</span><span class="va">vcv</span>, boundaries <span class="op">=</span> <span class="st">"reflect"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vcv">vcv<a class="anchor" aria-label="anchor" href="#arg-vcv"></a></dt>
<dd><p>A list of variance covariance matrices.  We expect this
to be a list with elements <code>base</code> and <code>groups</code> corresponding to
the covariance matrix for base parameters (if any) and groups.</p></dd>


<dt id="arg-boundaries">boundaries<a class="anchor" aria-label="anchor" href="#arg-boundaries"></a></dt>
<dd><p>Control the behaviour of proposals that are
outside the model domain.  The supported options are:</p><ul><li><p>"reflect" (the default): we reflect proposed parameters that
lie outside the domain back into the domain (as many times as
needed)</p></li>
<li><p>"reject": we do not evaluate the density function, and return
<code>-Inf</code> for its density instead.</p></li>
<li><p>"ignore": evaluate the point anyway, even if it lies outside
the domain.</p></li>
</ul><p>The initial point selected will lie within the domain, as this is
enforced by <a href="mcstate_sample.html">mcstate_sample</a>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>mcstate_sampler</code> object, which can be used with
<a href="mcstate_sample.html">mcstate_sample</a></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The intended use case for this sampler is for models where the
density can be decomposed at least partially into chunks that are
independent from each other.  Our motivating example for this is a
model of COVID-19 transmission where some parameters
region-specific (e.g., patterns and rates of contact between
individuals), and some parameters are shared across all regions
(e.g., intrinsic properties of the disease such as incubation
period).</p>
<p>The strategy is to propose all the shared parameters as a
deviation from the current point in parameter space as a single
move and accept or reject as a block. Then we generate points for
all the region-specific parameters, compute the density and then
accept or reject these updates independently.  This is possible
because the change in likelihood in region A is independent from
region B.</p>
<p>We expect that this approach will be beneficial in limited
situations, but where it is beneficial it is likely to result in
fairly large speedups:</p><ul><li><p>You probably need more than three regions; as the number of
regions increases the benefit independently accepting or
rejecting densities increases (with 1000 separate regions your
chains will mix very slowly for example).</p></li>
<li><p>Your model is fairly comutationally heavy so that the density
calculation completely dominates the sampling process.</p></li>
<li><p>You do not have access to gradient information for your model;
we suspect that HMC will outperform this approach by some margin
because it already includes this independence via the gradients.</p></li>
<li><p>You can compute your independent calculations in parallel, which
help this method reduce your walk time.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

