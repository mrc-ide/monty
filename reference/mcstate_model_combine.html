<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combine two models — mcstate_model_combine • mcstate2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combine two models — mcstate_model_combine"><meta name="description" content="Combine two models by multiplication.  We'll need a better name
here.  In Bayesian inference we will want to create a model that
represents the multiplication of a likelihood and a prior (in log
space) and it will be convenient to think about these models
separately.  Multiplying probabilities (or adding on a log scale)
is common enough that there may be other situations where we want
to do this."><meta property="og:description" content="Combine two models by multiplication.  We'll need a better name
here.  In Bayesian inference we will want to create a model that
represents the multiplication of a likelihood and a prior (in log
space) and it will be convenient to think about these models
separately.  Multiplying probabilities (or adding on a log scale)
is common enough that there may be other situations where we want
to do this."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcstate2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mcstate2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dsl-errors.html">DSL parse errors</a></li>
    <li><a class="dropdown-item" href="../articles/dsl.html">Probabilistic DSL</a></li>
    <li><a class="dropdown-item" href="../articles/samplers.html">Samplers</a></li>
    <li><a class="dropdown-item" href="../articles/samples.html">Working with samples</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mrc-ide/mcstate2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Combine two models</h1>
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/mcstate2/blob/main/R/combine.R" class="external-link"><code>R/combine.R</code></a></small>
      <div class="d-none name"><code>mcstate_model_combine.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Combine two models by multiplication.  We'll need a better name
here.  In Bayesian inference we will want to create a model that
represents the multiplication of a likelihood and a prior (in log
space) and it will be convenient to think about these models
separately.  Multiplying probabilities (or adding on a log scale)
is common enough that there may be other situations where we want
to do this.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcstate_model_combine</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, properties <span class="op">=</span> <span class="cn">NULL</span>, name_a <span class="op">=</span> <span class="st">"a"</span>, name_b <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>The first model</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>The second model</p></dd>


<dt id="arg-properties">properties<a class="anchor" aria-label="anchor" href="#arg-properties"></a></dt>
<dd><p>An <a href="mcstate_model_properties.html">mcstate_model_properties</a> object, used to
control (or enforce) properties of the combined model.</p></dd>


<dt id="arg-name-a">name_a<a class="anchor" aria-label="anchor" href="#arg-name-a"></a></dt>
<dd><p>Name of the first model (defaulting to 'a'); you can
use this to make error messages nicer to read, but it has no
other practical effect.</p></dd>


<dt id="arg-name-b">name_b<a class="anchor" aria-label="anchor" href="#arg-name-b"></a></dt>
<dd><p>Name of the first model (defaulting to 'b'); you can
use this to make error messages nicer to read, but it has no
other practical effect.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <a href="mcstate_model.html">mcstate_model</a> object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Here we describe the impact of combining a pair of models</p><ul><li><p><code>density</code>: this is the sum of the log densities from each model</p></li>
<li><p><code>parameters</code>: the union of parameters from each model is taken</p></li>
<li><p><code>domain</code>: The most restrictive domain is taken for each
parameter.  Parameters that do not appear in one model are
assumed to have infinite domain there.</p></li>
<li><p><code>gradient</code>: if <em>both</em> models define a gradient, this is the sum
of the gradients.  If either does not define a gradient, the
resulting model will not have gradient support.  Set
<code>has_gradient = TRUE</code> within `properties if you want to enforce
that the combination is differentiable.  If the models disagree
in their parameters, parameters that are missing from a model
are assumed (reasonably) to have a zero gradient.</p></li>
<li><p><code>direct_sample</code>: this one is hard to do the right thing for.  If
neither model can be directly sampled from that's fine, we
don't directly sample.  If only one model can be sampled from
<em>and</em> if it can sample from the union of all parameters then we
take that function (this is the case for a prior model when
combined with a likelihood).  Other cases will be errors, which
can be avoided by setting <code>has_direct_gradient = FALSE</code> in
<code>properties</code>.</p></li>
<li><p><code>is_stochastic</code>: a model is stochastic if <em>either</em> component is
stochastic.</p></li>
</ul><p>The properties of the model will be combined as above, reflecting
the properties of the joint model.</p>
<p>The <code>model</code> field will be an ordered, unnamed, list containing the
two elements corresponding to the first and second model (not the
<code>mcstate_model</code>, but the underlying model, perhaps?).  This is the
only part that makes a distinction between the two models here;
for all components above they are equivalent.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

